{
  // Local devcontainer for xrisk-pause-game (Jörn's Ubuntu desktop).
  // PRIMARY ENVIRONMENT.
  //
  // Features:
  // - Bind mounts for cache persistence (npm, Playwright browsers)
  // - Bind mounts for OAuth persistence (gh, claude)
  // - Playwright + Chromium for E2E tests
  //
  // Prerequisites on host:
  // - /srv/devhome/ directories exist (shared with msc-math devcontainer)
  // - /srv/devhome/.cache/npm/ and /srv/devhome/.cache/ms-playwright/ exist
  // - /srv/devworktrees/xrisk-pause-game/worktrees/ exists
  // - devcontainer CLI: npm i -g @devcontainers/cli
  //
  // Usage from host:
  //   .devcontainer/host-devcontainer-rebuild.sh
  //   .devcontainer/host-vscode-tunnel.sh
  "name": "xrisk-pause-game-local",
  "dockerFile": "Dockerfile",
  "workspaceFolder": "/workspaces/xrisk-pause-game",
  "updateRemoteUserUID": true,
  "features": {},
  // Memory limit: 10GB RAM + 2GB swap max. Protects host from runaway processes.
  // --cap-add=SYS_ADMIN: needed for perf, strace, and other profiling tools.
  "runArgs": ["--memory=10g", "--memory-swap=12g", "--cap-add=SYS_ADMIN"],
  "postCreateCommand": "bash .devcontainer/post-create.sh",
  "containerEnv": {
    "DEVCONTAINER_ENV": "local",
    "HISTFILE": "/home/vscode/.bash_history_dir/.bash_history",
    // Claude Code stores .claude.json at $CLAUDE_CONFIG_DIR (default: $HOME).
    // Must point inside ~/.claude/ so it's included in the bind mount.
    "CLAUDE_CONFIG_DIR": "/home/vscode/.claude",
    // Store VS Code tunnel auth in ~/.vscode-cli instead of system keychain
    "VSCODE_CLI_USE_FILE_KEYCHAIN": "1"
  },
  // Bind mounts: Jörn's specific host paths for cache persistence.
  "mounts": [
    "source=/srv/devhome/.claude,target=/home/vscode/.claude,type=bind,consistency=cached",
    "source=/srv/devhome/.config/gh,target=/home/vscode/.config/gh,type=bind,consistency=cached",
    "source=/srv/devhome/.cache/npm,target=/home/vscode/.cache/npm,type=bind,consistency=cached",
    "source=/srv/devhome/.cache/ms-playwright,target=/home/vscode/.cache/ms-playwright,type=bind,consistency=cached",
    "source=/srv/devhome/.bash_history_dir,target=/home/vscode/.bash_history_dir,type=bind,consistency=cached",
    "source=/srv/devworktrees/xrisk-pause-game/worktrees,target=/workspaces/worktrees,type=bind,consistency=cached",
    "source=/srv/devhome/.vscode-cli,target=/home/vscode/.vscode-cli,type=bind,consistency=cached"
  ]
}
